# PBL App in 2025

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€**è¤‡æ•°ãƒãƒ¼ãƒ ï¼ˆteam_a, team_b,
...ï¼‰ã”ã¨ã«ç‹¬ç«‹ã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»DB(SQLite)ã‚’é‹ç”¨**ã—ã¤ã¤ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›´ä¸‹ã§ä¸€å…ƒç®¡ç†ã™ã‚‹æ§‹æˆã§ã™ã€‚

------------------------------------------------------------------------

## ğŸ“¦ å¿…è¦ãªç’°å¢ƒ

- Python 3.9+ æ¨å¥¨
- [uv](https://github.com/astral-sh/uv)ï¼ˆä¾å­˜è§£æ±ºãƒ»ä»®æƒ³ç’°å¢ƒç®¡ç†ã«ä½¿ç”¨ï¼‰

```bash
#### å„ç’°å¢ƒæ¯ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³• ####
# On macOS and Linux.
curl -LsSf https://astral.sh/uv/install.sh | sh
# On Windows.
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
```

- SQLite3 (ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ä¸è¦ã§ã™)
- Git

------------------------------------------------------------------------

## ğŸš€ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

1. ä»®æƒ³ç’°å¢ƒã‚’ä½œæˆ

``` bash
uv venv
```

1. ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

``` bash
uv sync
```

1. DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

``` bash
# 1. å„ãƒãƒ¼ãƒ å…±é€šã§è¡Œã£ã¦ãã ã•ã„
python manage.py makemigrations
# 2. team_aã¯ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
python manage.py migrate --database=team_a
# 2. team_bã¯ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
python manage.py migrate --database=team_b
```

------------------------------------------------------------------------

## â–¶ï¸ èµ·å‹•æ–¹æ³•

### ã‚¢ãƒ—ãƒª

``` bash
uv run python manage.py runserver
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§ <http://127.0.0.1:8000/> ã«ã‚¢ã‚¯ã‚»ã‚¹ã€‚

- `/` â†’ å…¨ä½“ã®Indexï¼ˆå„ãƒãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯
- `/team-a/` â†’ Team A Index
- `/team-b/` â†’ Team B Index

### DB

```bash
# team_aã®å ´åˆ
python manage.py dbshell --database=team_a
# team_bã®å ´åˆ
python manage.py dbshell --database=team_b
```

------------------------------------------------------------------------

## ğŸ“‚ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```text
.
â”œâ”€â”€ .gitignore               # Gité™¤å¤–ãƒ•ã‚¡ã‚¤ãƒ«è¨­å®š
â”œâ”€â”€ .python-version          # ä½¿ç”¨ã™ã‚‹Pythonãƒãƒ¼ã‚¸ãƒ§ãƒ³(pyenv)
â”œâ”€â”€ README.md
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ deploy.yaml      # self-hosted runner ç”¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
â”œâ”€â”€ manage.py
â”œâ”€â”€ main.py
â”œâ”€â”€ db.sqlite3               # default DB
â”œâ”€â”€ .venv/                   # ä»®æƒ³ç’°å¢ƒ(å¿…è¦ã«å¿œã˜ã¦)
â”œâ”€â”€ pbl_project/             # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ asgi.py
â”‚   â”œâ”€â”€ settings.py          # è¤‡æ•°DB / ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨­å®š
â”‚   â”œâ”€â”€ urls.py              # å…¨ä½“URLãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
â”‚   â””â”€â”€ wsgi.py
â”œâ”€â”€ routers.py               # DBãƒ«ãƒ¼ã‚¿ãƒ¼ï¼ˆappâ†’DBå‰²å½“ï¼‰
â”œâ”€â”€ templates/               # â˜…ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ã“ã“ã«é›†ç´„
â”‚   â”œâ”€â”€ top.html             # å…¨ä½“ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸
â”‚   â””â”€â”€ team_a/
â”‚       â””â”€â”€ members.html
â”œâ”€â”€ docs/                    # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé¡
â”‚   â”œâ”€â”€ HOW_TO_DATA_INSERT_BY_MIGRATION.md
â”‚   â”œâ”€â”€ HOW_TO_DEPLOY.md
â”‚   â”œâ”€â”€ HOW_TO_RESOLVE_CONFLICTS.md
â”‚   â”œâ”€â”€ NEW_TEAM_SETUP.md
â”‚   â”œâ”€â”€ SQLITE3_INSTALLATION.md
â”‚   â””â”€â”€ UV_INSTALLATION.md
â”œâ”€â”€ images/                  # ç”»åƒãƒªã‚½ãƒ¼ã‚¹
â”œâ”€â”€ team_a/                  # å„ãƒãƒ¼ãƒ ç”¨ã‚¢ãƒ—ãƒªï¼ˆteam_a / team_b ...ï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ admin.py
â”‚   â”œâ”€â”€ apps.py
â”‚   â”œâ”€â”€ db.sqlite3
â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ 0001_initial.py
â”‚   â”œâ”€â”€ models.py
â”‚   â”œâ”€â”€ tests.py
â”‚   â”œâ”€â”€ urls.py
â”‚   â””â”€â”€ views.py
â”œâ”€â”€ team_b/
â”‚   â””â”€â”€ ...                  # ä»–ãƒãƒ¼ãƒ ã‚‚åŒæ§˜ã®æ§‹æˆ
â”œâ”€â”€ pyproject.toml           # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†(uv)
â”œâ”€â”€ uv.lock                  # ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«
â””â”€â”€ work/                    # è£œåŠ©ã‚¹ã‚¯ãƒªãƒ—ãƒˆç­‰
```

------------------------------------------------------------------------

## âš ï¸ é‹ç”¨ä¸Šã®æ³¨æ„ç‚¹

- **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯å¿…ãš `templates/` é…ä¸‹ã«é…ç½®**ã—ã¦ãã ã•ã„ã€‚
    å„ã‚¢ãƒ—ãƒªé…ä¸‹ã® `templates/` ã¯å‚ç…§ã•ã‚Œã¾ã›ã‚“ (`APP_DIRS=False`)ã€‚

- **ãƒãƒ¼ãƒ ã”ã¨ã«SQLiteã‚’åˆ†é›¢**ã—ã¦ã„ã¾ã™ã€‚

  - `team_a` ã®ãƒ¢ãƒ‡ãƒ«ã¯ `team_a/db.sqlite3` ã«ä¿å­˜
  - `team_b` ã®ãƒ¢ãƒ‡ãƒ«ã¯ `team_b/db.sqlite3` ã«ä¿å­˜
  - `views.py` å†…ã§ `.using("team_a")` / `.using("team_b")`
        ã‚’æ˜ç¤ºã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚

- **ç•°ãªã‚‹DBé–“ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ä¸å¯**ã§ã™ï¼ˆDjangoã®è¤‡æ•°DBåˆ¶ç´„ï¼‰ã€‚
    ãƒãƒ¼ãƒ é–“ã§ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã¯ã€å…±é€šã® `default` DB
    ã‚’åˆ©ç”¨ã™ã‚‹ã‹ã€APIçµŒç”±ã§é€£æºã—ã¦ãã ã•ã„ã€‚

- **ä¾å­˜é–¢ä¿‚ã¯uvã§ç®¡ç†**ã—ã¾ã™ã€‚

  - ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å®šç¾©: `pyproject.toml`
  - ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«: `uv.lock`
  - ãƒãƒ¼ãƒ å›ºæœ‰ã®ä¾å­˜ãŒå¿…è¦ãªå ´åˆã¯`pyproject.toml`ã®optional-dependenciesã‚’æ´»ç”¨

- **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ãƒãƒ¼ãƒ ã”ã¨ã«å®Ÿè¡Œ**ã—ã¦ãã ã•ã„ã€‚

    ``` bash
    python manage.py migrate --database=team_a
    python manage.py migrate --database=team_b
    ```
