{# templates/teams/shiokara/company_experience_post.html #}
{% extends "teams/shiokara/base.html" %}
{% load static %}

{% block content %}
<style>
    .tut-logo-box {
        flex: 0 0 auto;
        order: 2;
        margin-left: auto;
    }

    .tut-page-title {
        order: 1;
    }

    .tut-logo-img {
        max-height: 56px;
        width: auto;
        display: block;
    }

    .tut-page-title h1 {
        margin: 0;
        font-size: 1.8rem;
        font-weight: 600;
        color: #42413F;
    }

    .tut-page-lead {
        margin: 4px 0 0;
        font-size: 0.9rem;
        line-height: 1.6;
    }

    .post-form-container {
        background: white;
        padding: 32px;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        margin-top: 24px;
        max-width: 800px;
    }

    .form-field {
        margin-bottom: 24px;
    }

    .form-field label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #333;
        font-size: 0.95rem;
    }

    .form-field input[type="text"],
    .form-field textarea {
        width: 100%;
        padding: 12px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 1rem;
        box-sizing: border-box;
        font-family: inherit;
    }

    .form-field input[type="text"]:focus,
    .form-field textarea:focus {
        outline: none;
        border-color: #cc0000;
        box-shadow: 0 0 0 3px rgba(204, 0, 0, 0.1);
    }

    .form-field small {
        display: block;
        margin-top: 6px;
        font-size: 0.85rem;
        color: #666;
    }

    .radio-group {
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
        margin-top: 8px;
    }

    .radio-group label {
        display: flex;
        align-items: center;
        gap: 6px;
        font-weight: normal;
        cursor: pointer;
    }

    .radio-group input[type="radio"] {
        cursor: pointer;
    }

    .stars {
        display: flex;
        gap: 4px;
        margin-top: 8px;
    }

    .star {
        font-size: 2rem;
        color: #ddd;
        background: none;
        border: none;
        padding: 4px;
        cursor: pointer;
        transition: all 0.2s;
    }

    .star:hover {
        transform: scale(1.15);
    }

    .star.filled {
        color: #ff9800;
    }

    .star:focus {
        outline: 2px solid #cc0000;
        border-radius: 4px;
    }

    .error-message {
        background: #ffebee;
        color: #c62828;
        padding: 12px 16px;
        border-radius: 6px;
        margin-bottom: 20px;
        border-left: 4px solid #c62828;
    }

    .form-actions {
        display: flex;
        gap: 12px;
        margin-top: 32px;
        padding-top: 24px;
        border-top: 1px solid #f0f0f0;
    }

    .btn-primary {
        flex: 1;
        padding: 14px 24px;
        background: #cc0000;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.2s;
    }

    .btn-primary:hover {
        background: #aa0000;
    }

    .btn-secondary {
        padding: 14px 24px;
        background: #f5f5f5;
        color: #333;
        border: 1px solid #ddd;
        border-radius: 6px;
        text-decoration: none;
        display: inline-block;
        transition: background 0.2s;
        text-align: center;
    }

    .btn-secondary:hover {
        background: #e8e8e8;
    }

    .info-box {
        background: #f0f7ff;
        border-left: 4px solid #0066cc;
        padding: 16px;
        border-radius: 6px;
        margin-bottom: 24px;
    }

    .info-box p {
        margin: 0;
        color: #333;
        line-height: 1.6;
    }

    @media (max-width: 640px) {
        .tut-page-header {
            flex-direction: column;
            align-items: flex-start;
        }
        .tut-logo-img {
            max-height: 44px;
        }
        .tut-page-title h1 {
            font-size: 1.5rem;
        }
        .post-form-container {
            padding: 20px;
        }
        .form-actions {
            flex-direction: column;
        }
        .star {
            font-size: 1.5rem;
        }
    }
</style>

<div class="tut-page-wrapper">
    <!-- å·¦å´ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    {% include "teams/shiokara/includes/sidebar.html" %}

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <div class="tut-main-content">
        <header class="tut-page-header page-header">
            <div class="tut-logo-box">
                <img src="{% static 'image/mark_gikanavi.png' %}"
                     alt="è±Šæ©‹æŠ€è¡“ç§‘å­¦å¤§å­¦ ãƒ­ã‚´" class="tut-logo-img">
            </div>
            <div class="tut-page-title">
                <h1>{{ company.name }} ã®å£ã‚³ãƒŸã‚’æŠ•ç¨¿</h1>
                <p class="tut-page-lead page-lead">
                    å¾Œè¼©ã®ãŸã‚ã«ã€ã‚ãªãŸã®ä½“é¨“ã‚’ã‚·ã‚§ã‚¢ã—ã¾ã—ã‚‡ã†
                </p>
            </div>
        </header>

        {% if error %}
        <div class="error-message">{{ error }}</div>
        {% endif %}

        <div class="info-box">
            <p>
                ğŸ’¡ ã“ã®ãƒšãƒ¼ã‚¸ã§ã¯ã€{{ company.name }} ã«é–¢ã™ã‚‹å°±æ´»ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ãƒ»ã‚¢ãƒ«ãƒã‚¤ãƒˆãªã©ã®ä½“é¨“ã‚’ã€
                å¾Œè¼©å‘ã‘ã®å£ã‚³ãƒŸã¨ã—ã¦å…±æœ‰ã§ãã¾ã™ã€‚æŠ•ç¨¿ã™ã‚‹ã¨<strong>5ãƒã‚¤ãƒ³ãƒˆ</strong>ç²å¾—ã§ãã¾ã™ï¼
            </p>
        </div>

        <div class="post-form-container">
            <form method="post" action="">
                {% csrf_token %}

                <div class="form-field">
                    <label for="id_grade">å­¦å¹´</label>
                    <input id="id_grade" type="text" name="grade" value="{{ grade }}" placeholder="ä¾‹: B3, M1 ãªã©">
                    <small>ç¾åœ¨ã®å­¦å¹´ã¾ãŸã¯ä½“é¨“æ™‚ã®å­¦å¹´ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</small>
                </div>

                <div class="form-field">
                    <label for="id_department_name">å­¦ç§‘</label>
                    <input id="id_department_name" type="text" name="department_name" value="{{ department_name }}" placeholder="ä¾‹: æƒ…å ±ãƒ»çŸ¥èƒ½å·¥å­¦(3ç³»)">
                </div>

                <div class="form-field">
                    <label for="id_lab_field">åˆ†é‡ï¼ˆç ”ç©¶å®¤ï¼‰</label>
                    <input id="id_lab_field" type="text" name="lab_field" value="{{ lab_field }}" placeholder="ä¾‹: ãƒ‡ãƒ¼ã‚¿æƒ…å ±å­¦åˆ†é‡">
                </div>

                <div class="form-field">
                    <label>æ€§åˆ¥</label>
                    <div class="radio-group">
                        <label>
                            <input type="radio" name="gender" value="male" {% if gender == "male" %}checked{% endif %}>
                            ç”·æ€§
                        </label>
                        <label>
                            <input type="radio" name="gender" value="female" {% if gender == "female" %}checked{% endif %}>
                            å¥³æ€§
                        </label>
                        <label>
                            <input type="radio" name="gender" value="other" {% if gender == "other" %}checked{% endif %}>
                            ãã®ä»–
                        </label>
                        <label>
                            <input type="radio" name="gender" value="no_answer" {% if gender == "no_answer" or not gender %}checked{% endif %}>
                            å›ç­”ã—ãªã„
                        </label>
                    </div>
                </div>

                <div class="form-field">
                    <label for="id_comment">å£ã‚³ãƒŸå†…å®¹</label>
                    <textarea id="id_comment" name="comment" rows="10" placeholder="ä¼æ¥­ã®é›°å›²æ°—ã€é¸è€ƒã®æµã‚Œã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ã®å†…å®¹ã€åƒãã‚„ã™ã•ãªã©ã€å¾Œè¼©ãŒçŸ¥ã‚ŠãŸã„æƒ…å ±ã‚’è‡ªç”±ã«è¨˜å…¥ã—ã¦ãã ã•ã„ã€‚">{{ comment }}</textarea>
                    <small>ã§ãã‚‹ã ã‘å…·ä½“çš„ã«æ›¸ã„ã¦ã„ãŸã ã‘ã‚‹ã¨ã€å¾Œè¼©ã«ã¨ã£ã¦å‚è€ƒã«ãªã‚Šã¾ã™</small>
                </div>

                <div class="form-field">
                    <label>è©•ä¾¡ï¼ˆâ˜…1ã€œ5ï¼‰</label>
                    <input type="hidden" name="rating" id="id_rating" value="{{ rating }}">
                    <div id="star_rating" class="stars" role="radiogroup" aria-label="è©•ä¾¡">
                        <button type="button" class="star" data-value="1" aria-label="1ã¤æ˜Ÿ">â˜…</button>
                        <button type="button" class="star" data-value="2" aria-label="2ã¤æ˜Ÿ">â˜…</button>
                        <button type="button" class="star" data-value="3" aria-label="3ã¤æ˜Ÿ">â˜…</button>
                        <button type="button" class="star" data-value="4" aria-label="4ã¤æ˜Ÿ">â˜…</button>
                        <button type="button" class="star" data-value="5" aria-label="5ã¤æ˜Ÿ">â˜…</button>
                    </div>
                    <small>ç·åˆçš„ãªæº€è¶³åº¦ã‚’æ˜Ÿã§è©•ä¾¡ã—ã¦ãã ã•ã„</small>
                </div>

                <script>
                    document.addEventListener('DOMContentLoaded', function () {
                        const stars = Array.from(document.querySelectorAll('#star_rating .star'));
                        const input = document.getElementById('id_rating');
                        let selected = parseInt(input.value) || 0;

                        function render(hover) {
                            stars.forEach((s, idx) => {
                                const v = idx + 1;
                                if (hover) {
                                    s.classList.toggle('filled', v <= hover);
                                } else {
                                    s.classList.toggle('filled', v <= selected);
                                }
                            });
                        }

                        stars.forEach((s, idx) => {
                            const v = idx + 1;
                            s.addEventListener('mouseover', () => render(v));
                            s.addEventListener('focus', () => render(v));
                            s.addEventListener('mouseout', () => render(0));
                            s.addEventListener('blur', () => render(0));
                            s.addEventListener('click', () => { selected = v; input.value = v; render(0); });
                            s.addEventListener('keydown', (e) => {
                                if (e.key === 'Enter' || e.key === ' ') {
                                    e.preventDefault();
                                    selected = v;
                                    input.value = v;
                                    render(0);
                                }
                            });
                        });

                        // åˆæœŸè¡¨ç¤º
                        render(0);
                    });
                </script>

                <div class="form-actions">
                    <button type="submit" class="btn-primary">å£ã‚³ãƒŸã‚’æŠ•ç¨¿ã™ã‚‹</button>
                    <a href="{% url 'shiokara:company_detail' company.pk %}" class="btn-secondary">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}