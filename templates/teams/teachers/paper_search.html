{% extends "teams/teachers/base.html" %}
{% block title %}論文検索 | Paper DB{% endblock %}

{% block content %}
  <div class="card" style="margin-top:16px;">
    <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
      <h2 style="margin:0; font-size:18px;">論文検索</h2>
      {% if query %}
        <span class="muted" style="font-size:13px;">“{{ query }}”</span>
      {% endif %}
    </div>

    <form method="get" style="margin-top:12px;">
      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <input
          type="text"
          name="q"
          value="{{ query }}"
          placeholder="タイトル・著者・掲載誌・DOI・キーワード・本文など"
          style="flex: 1 1 420px;"
        >
        <button class="btn primary" type="submit">検索</button>
        <a class="btn" href="{% url 'teachers:paper_search' %}">クリア</a>
      </div>
      <div class="help" style="margin-top:8px;">
        例）"SimCLR" / "TOYOPay" / "Ohmura" / "2025" など
      </div>
    </form>
  </div>

  <div class="card" style="margin-top:16px;">
    <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
      <h2 style="margin:0; font-size:16px;">検索結果</h2>
      {% if query %}
        <span class="muted" style="font-size:13px;">
          {{ results|length }} 件
        </span>
      {% else %}
        <span class="muted" style="font-size:13px;">
          キーワードを入力して検索してください
        </span>
      {% endif %}
    </div>

    <div style="overflow-x:auto; margin-top:12px;">
      <table style="width:100%; border-collapse:collapse; font-size:14px;">
      <thead>
      <tr style="background:#f8fafc;">
        <th>{% include "teams/teachers/sort_th.html" with label="題目" key="title" %}</th>
        <th>{% include "teams/teachers/sort_th.html" with label="著者" key="author" %}</th>
        <th style="width:70px; text-align:right;">
        {% include "teams/teachers/sort_th.html" with label="年" key="year" %}
        </th>
        <th>{% include "teams/teachers/sort_th.html" with label="掲載誌" key="booktitle" %}</th>
        <th style="width:90px;">
        {% include "teams/teachers/sort_th.html" with label="登録者" key="submitter" %}
        </th>
        <th style="width:150px;">
        {% include "teams/teachers/sort_th.html" with label="登録時刻" key="submit_time" %}
        </th>
      </tr>
      </thead>

        <tbody>
          {% for paper in results %}
            <tr style="border-top:1px solid var(--line);">
              <td style="padding:10px 8px;">
                <a href="{% url 'teachers:paper_detail' paper.pk %}">
                  {{ paper.title }}
                </a>
              </td>
              <td style="padding:10px 8px;">{{ paper.author }}</td>
              <td style="padding:10px 8px; text-align:right;">{{ paper.year }}</td>
              <td style="padding:10px 8px;">{{ paper.booktitle }}</td>
              <td style="padding:10px 8px;">{{ paper.submitter }}</td>
              <td style="padding:10px 8px;">{{ paper.submit_time|date:"Y-m-d H:i" }}</td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="6" class="muted" style="padding:14px; text-align:center;">
                {% if query %}
                  該当する論文はありません
                {% else %}
                  まだ検索していません
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% endblock %}