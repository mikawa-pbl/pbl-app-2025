<div class="relative w-full h-[400px] overflow-hidden rounded-lg shadow-lg mb-8" id="carousel">
    <div class="flex transition-transform duration-500 ease-in-out h-full" id="carousel-slides">
        {% for good in slider_goods %}
        <div class="min-w-full h-full relative">
            {% if good.image_filename %}
            <img src="{% url 'team_cake:cake_image' good.image_filename %}" class="w-full h-full object-cover">
            {% else %}
            <img src="https://placehold.co/800x400?text={{ good.name }}" class="w-full h-full object-cover">
            {% endif %}
            <div
                class="absolute inset-0 flex flex-col items-center justify-center bg-black bg-opacity-40 text-white text-center p-4">
                <h3 class="text-4xl font-bold mb-2 drop-shadow-md">{{ good.name }}</h3>
                <h5 class="text-xl font-light mb-1 drop-shadow-sm">{{ good.description|default:""|truncatechars:50 }}
                </h5>
                <h5 class="text-xl font-light drop-shadow-sm">Â¥{{ good.price }}</h5>
            </div>
        </div>
        {% empty %}
        <div class="min-w-full h-full relative">
            <img src="https://placehold.co/800x400?text=No+Cakes+Yet" class="w-full h-full object-cover">
            <div
                class="absolute inset-0 flex flex-col items-center justify-center bg-black bg-opacity-40 text-white text-center p-4">
                <h3 class="text-4xl font-bold mb-2">Welcome to Team Cake!</h3>
                <h5 class="text-xl font-light">Register some goods to see them here.</h5>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Indicators -->
    <div class="absolute bottom-4 left-0 right-0 flex justify-center space-x-4">
        {% for good in slider_goods %}
        <button
            class="carousel-indicator w-4 h-4 rounded-full bg-[#F5E829] border border-gray-300 opacity-50 hover:opacity-100 transition-all duration-300"
            onclick="goToSlide({{ forloop.counter0 }})"></button>
        {% empty %}
        <button
            class="carousel-indicator w-4 h-4 rounded-full bg-[#F5E829] border border-gray-300 opacity-50 transition-all duration-300"></button>
        {% endfor %}
    </div>
</div>

<script>
    let currentSlide = 0;
    const slidesContainer = document.getElementById('carousel-slides');
    const slideCount = {{ slider_goods| length }} || 1;
    const indicators = document.querySelectorAll('.carousel-indicator');

    function goToSlide(index) {
        currentSlide = index;
        updateCarousel();
    }

    function nextSlide() {
        currentSlide = (currentSlide + 1) % slideCount;
        updateCarousel();
    }

    function updateCarousel() {
        slidesContainer.style.transform = `translateX(-${currentSlide * 100}%)`;

        indicators.forEach((indicator, index) => {
            if (index === currentSlide) {
                indicator.classList.remove('opacity-50', 'scale-100');
                indicator.classList.add('opacity-100', 'scale-125', 'ring-2', 'ring-white', 'shadow-lg');
            } else {
                indicator.classList.remove('opacity-100', 'scale-125', 'ring-2', 'ring-white', 'shadow-lg');
                indicator.classList.add('opacity-50', 'scale-100');
            }
        });
    }

    // Initialize indicators
    updateCarousel();

    if (slideCount > 1) {
        setInterval(nextSlide, 6000);
    }
</script>